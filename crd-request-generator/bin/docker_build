#!/usr/bin/env bash
BIN="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
PWD=$(pwd)
print="$BIN/../../shared/print"

source "$BIN"/SET

$print "Building image $IMAGE:$VERSION ..."
cd "$BIN"/../../../crd-request-generator || exit

[ -d node_modules ] && rm -rf node_modules
[ -f package-lock.json ] && rm -f package-lock.json

#docker build -f Dockerfile.dev -t "${IMAGE}":"${VERSION}" .
#docker tag "${IMAGE}":"${VERSION}" "${IMAGE}":latest
docker build -f Dockerfile.dev -t "$TAG" -t "$LATEST" --build-arg VERSION="$VERSION" --build-arg BUILD_TIMESTAMP="$BUILD_TIMESTAMP" .

$print  "Created image $TAG" INFO

cd "$PWD" || exit